<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Post-review: Migrating CRA to Vite</title><meta property="og:type" content="article"/><meta property="og:title" content="Post-review: Migrating CRA to Vite"/><meta property="org:url" content="https://wkrueger.github.io/articles/2022-07-ret-cra-to-vite"/><meta name="next-head-count" content="6"/><link rel="icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;ðŸ§±&lt;/text&gt;&lt;/svg&gt;"/><meta property="og:type" content="website"/><meta property="og:image" content="https://wkrueger.github.io/Brick-2400.jpg"/><link rel="preload" href="/_next/static/css/8cbae78537cc2728.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8cbae78537cc2728.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-2b04c81e42484477.js" defer=""></script><script src="/_next/static/chunks/framework-ae4f43955bfa5ddc.js" defer=""></script><script src="/_next/static/chunks/main-3cf1b4d0a841b0b4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-811eea6034ad511d.js" defer=""></script><script src="/_next/static/chunks/426-78d330e9135c2b2c.js" defer=""></script><script src="/_next/static/chunks/57-3c5480c73e46d2a7.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bslug%5D-a01e24d87445ed4b.js" defer=""></script><script src="/_next/static/Rj-u9m2TXNHyaCr0beF96/_buildManifest.js" defer=""></script><script src="/_next/static/Rj-u9m2TXNHyaCr0beF96/_ssgManifest.js" defer=""></script></head><body><script id="chakra-script">!(function(){try{var a=function(c){var v="(prefers-color-scheme: dark)",h=window.matchMedia(v).matches?"dark":"light",r=c==="system"?h:c,o=document.documentElement,s=document.body,l="chakra-ui-light",d="chakra-ui-dark",i=r==="dark";return s.classList.add(i?d:l),s.classList.remove(i?l:d),o.style.colorScheme=r,o.dataset.theme=r,r},n=a,m="dark",e="chakra-ui-color-mode",t=localStorage.getItem(e);t?a(t):localStorage.setItem(e,a(m))}catch(a){}})();</script><div id="__next"><style data-emotion="css-global uae3nb">:host,:root,[data-theme]{--chakra-ring-inset:var(--chakra-empty,/*!*/ /*!*/);--chakra-ring-offset-width:0px;--chakra-ring-offset-color:#fff;--chakra-ring-color:rgba(66, 153, 225, 0.6);--chakra-ring-offset-shadow:0 0 #0000;--chakra-ring-shadow:0 0 #0000;--chakra-space-x-reverse:0;--chakra-space-y-reverse:0;--chakra-colors-transparent:transparent;--chakra-colors-current:currentColor;--chakra-colors-black:#000000;--chakra-colors-white:#FFFFFF;--chakra-colors-whiteAlpha-50:rgba(255, 255, 255, 0.04);--chakra-colors-whiteAlpha-100:rgba(255, 255, 255, 0.06);--chakra-colors-whiteAlpha-200:rgba(255, 255, 255, 0.08);--chakra-colors-whiteAlpha-300:rgba(255, 255, 255, 0.16);--chakra-colors-whiteAlpha-400:rgba(255, 255, 255, 0.24);--chakra-colors-whiteAlpha-500:rgba(255, 255, 255, 0.36);--chakra-colors-whiteAlpha-600:rgba(255, 255, 255, 0.48);--chakra-colors-whiteAlpha-700:rgba(255, 255, 255, 0.64);--chakra-colors-whiteAlpha-800:rgba(255, 255, 255, 0.80);--chakra-colors-whiteAlpha-900:rgba(255, 255, 255, 0.92);--chakra-colors-blackAlpha-50:rgba(0, 0, 0, 0.04);--chakra-colors-blackAlpha-100:rgba(0, 0, 0, 0.06);--chakra-colors-blackAlpha-200:rgba(0, 0, 0, 0.08);--chakra-colors-blackAlpha-300:rgba(0, 0, 0, 0.16);--chakra-colors-blackAlpha-400:rgba(0, 0, 0, 0.24);--chakra-colors-blackAlpha-500:rgba(0, 0, 0, 0.36);--chakra-colors-blackAlpha-600:rgba(0, 0, 0, 0.48);--chakra-colors-blackAlpha-700:rgba(0, 0, 0, 0.64);--chakra-colors-blackAlpha-800:rgba(0, 0, 0, 0.80);--chakra-colors-blackAlpha-900:rgba(0, 0, 0, 0.92);--chakra-colors-gray-50:#F7FAFC;--chakra-colors-gray-100:#EDF2F7;--chakra-colors-gray-200:#E2E8F0;--chakra-colors-gray-300:#CBD5E0;--chakra-colors-gray-400:#A0AEC0;--chakra-colors-gray-500:#718096;--chakra-colors-gray-600:#4A5568;--chakra-colors-gray-700:#2D3748;--chakra-colors-gray-800:#1A202C;--chakra-colors-gray-900:#171923;--chakra-colors-red-50:#FFF5F5;--chakra-colors-red-100:#FED7D7;--chakra-colors-red-200:#FEB2B2;--chakra-colors-red-300:#FC8181;--chakra-colors-red-400:#F56565;--chakra-colors-red-500:#E53E3E;--chakra-colors-red-600:#C53030;--chakra-colors-red-700:#9B2C2C;--chakra-colors-red-800:#822727;--chakra-colors-red-900:#63171B;--chakra-colors-orange-50:#FFFAF0;--chakra-colors-orange-100:#FEEBC8;--chakra-colors-orange-200:#FBD38D;--chakra-colors-orange-300:#F6AD55;--chakra-colors-orange-400:#ED8936;--chakra-colors-orange-500:#DD6B20;--chakra-colors-orange-600:#C05621;--chakra-colors-orange-700:#9C4221;--chakra-colors-orange-800:#7B341E;--chakra-colors-orange-900:#652B19;--chakra-colors-yellow-50:#FFFFF0;--chakra-colors-yellow-100:#FEFCBF;--chakra-colors-yellow-200:#FAF089;--chakra-colors-yellow-300:#F6E05E;--chakra-colors-yellow-400:#ECC94B;--chakra-colors-yellow-500:#D69E2E;--chakra-colors-yellow-600:#B7791F;--chakra-colors-yellow-700:#975A16;--chakra-colors-yellow-800:#744210;--chakra-colors-yellow-900:#5F370E;--chakra-colors-green-50:#F0FFF4;--chakra-colors-green-100:#C6F6D5;--chakra-colors-green-200:#9AE6B4;--chakra-colors-green-300:#68D391;--chakra-colors-green-400:#48BB78;--chakra-colors-green-500:#38A169;--chakra-colors-green-600:#2F855A;--chakra-colors-green-700:#276749;--chakra-colors-green-800:#22543D;--chakra-colors-green-900:#1C4532;--chakra-colors-teal-50:#E6FFFA;--chakra-colors-teal-100:#B2F5EA;--chakra-colors-teal-200:#81E6D9;--chakra-colors-teal-300:#4FD1C5;--chakra-colors-teal-400:#38B2AC;--chakra-colors-teal-500:#319795;--chakra-colors-teal-600:#2C7A7B;--chakra-colors-teal-700:#285E61;--chakra-colors-teal-800:#234E52;--chakra-colors-teal-900:#1D4044;--chakra-colors-blue-50:#ebf8ff;--chakra-colors-blue-100:#bee3f8;--chakra-colors-blue-200:#90cdf4;--chakra-colors-blue-300:#63b3ed;--chakra-colors-blue-400:#4299e1;--chakra-colors-blue-500:#3182ce;--chakra-colors-blue-600:#2b6cb0;--chakra-colors-blue-700:#2c5282;--chakra-colors-blue-800:#2a4365;--chakra-colors-blue-900:#1A365D;--chakra-colors-cyan-50:#EDFDFD;--chakra-colors-cyan-100:#C4F1F9;--chakra-colors-cyan-200:#9DECF9;--chakra-colors-cyan-300:#76E4F7;--chakra-colors-cyan-400:#0BC5EA;--chakra-colors-cyan-500:#00B5D8;--chakra-colors-cyan-600:#00A3C4;--chakra-colors-cyan-700:#0987A0;--chakra-colors-cyan-800:#086F83;--chakra-colors-cyan-900:#065666;--chakra-colors-purple-50:#FAF5FF;--chakra-colors-purple-100:#E9D8FD;--chakra-colors-purple-200:#D6BCFA;--chakra-colors-purple-300:#B794F4;--chakra-colors-purple-400:#9F7AEA;--chakra-colors-purple-500:#805AD5;--chakra-colors-purple-600:#6B46C1;--chakra-colors-purple-700:#553C9A;--chakra-colors-purple-800:#44337A;--chakra-colors-purple-900:#322659;--chakra-colors-pink-50:#FFF5F7;--chakra-colors-pink-100:#FED7E2;--chakra-colors-pink-200:#FBB6CE;--chakra-colors-pink-300:#F687B3;--chakra-colors-pink-400:#ED64A6;--chakra-colors-pink-500:#D53F8C;--chakra-colors-pink-600:#B83280;--chakra-colors-pink-700:#97266D;--chakra-colors-pink-800:#702459;--chakra-colors-pink-900:#521B41;--chakra-colors-linkedin-50:#E8F4F9;--chakra-colors-linkedin-100:#CFEDFB;--chakra-colors-linkedin-200:#9BDAF3;--chakra-colors-linkedin-300:#68C7EC;--chakra-colors-linkedin-400:#34B3E4;--chakra-colors-linkedin-500:#00A0DC;--chakra-colors-linkedin-600:#008CC9;--chakra-colors-linkedin-700:#0077B5;--chakra-colors-linkedin-800:#005E93;--chakra-colors-linkedin-900:#004471;--chakra-colors-facebook-50:#E8F4F9;--chakra-colors-facebook-100:#D9DEE9;--chakra-colors-facebook-200:#B7C2DA;--chakra-colors-facebook-300:#6482C0;--chakra-colors-facebook-400:#4267B2;--chakra-colors-facebook-500:#385898;--chakra-colors-facebook-600:#314E89;--chakra-colors-facebook-700:#29487D;--chakra-colors-facebook-800:#223B67;--chakra-colors-facebook-900:#1E355B;--chakra-colors-messenger-50:#D0E6FF;--chakra-colors-messenger-100:#B9DAFF;--chakra-colors-messenger-200:#A2CDFF;--chakra-colors-messenger-300:#7AB8FF;--chakra-colors-messenger-400:#2E90FF;--chakra-colors-messenger-500:#0078FF;--chakra-colors-messenger-600:#0063D1;--chakra-colors-messenger-700:#0052AC;--chakra-colors-messenger-800:#003C7E;--chakra-colors-messenger-900:#002C5C;--chakra-colors-whatsapp-50:#dffeec;--chakra-colors-whatsapp-100:#b9f5d0;--chakra-colors-whatsapp-200:#90edb3;--chakra-colors-whatsapp-300:#65e495;--chakra-colors-whatsapp-400:#3cdd78;--chakra-colors-whatsapp-500:#22c35e;--chakra-colors-whatsapp-600:#179848;--chakra-colors-whatsapp-700:#0c6c33;--chakra-colors-whatsapp-800:#01421c;--chakra-colors-whatsapp-900:#001803;--chakra-colors-twitter-50:#E5F4FD;--chakra-colors-twitter-100:#C8E9FB;--chakra-colors-twitter-200:#A8DCFA;--chakra-colors-twitter-300:#83CDF7;--chakra-colors-twitter-400:#57BBF5;--chakra-colors-twitter-500:#1DA1F2;--chakra-colors-twitter-600:#1A94DA;--chakra-colors-twitter-700:#1681BF;--chakra-colors-twitter-800:#136B9E;--chakra-colors-twitter-900:#0D4D71;--chakra-colors-telegram-50:#E3F2F9;--chakra-colors-telegram-100:#C5E4F3;--chakra-colors-telegram-200:#A2D4EC;--chakra-colors-telegram-300:#7AC1E4;--chakra-colors-telegram-400:#47A9DA;--chakra-colors-telegram-500:#0088CC;--chakra-colors-telegram-600:#007AB8;--chakra-colors-telegram-700:#006BA1;--chakra-colors-telegram-800:#005885;--chakra-colors-telegram-900:#003F5E;--chakra-borders-none:0;--chakra-borders-1px:1px solid;--chakra-borders-2px:2px solid;--chakra-borders-4px:4px solid;--chakra-borders-8px:8px solid;--chakra-fonts-heading:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--chakra-fonts-body:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--chakra-fonts-mono:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--chakra-fontSizes-xs:0.75rem;--chakra-fontSizes-sm:0.875rem;--chakra-fontSizes-md:1rem;--chakra-fontSizes-lg:1.125rem;--chakra-fontSizes-xl:1.25rem;--chakra-fontSizes-2xl:1.5rem;--chakra-fontSizes-3xl:1.875rem;--chakra-fontSizes-4xl:2.25rem;--chakra-fontSizes-5xl:3rem;--chakra-fontSizes-6xl:3.75rem;--chakra-fontSizes-7xl:4.5rem;--chakra-fontSizes-8xl:6rem;--chakra-fontSizes-9xl:8rem;--chakra-fontWeights-hairline:100;--chakra-fontWeights-thin:200;--chakra-fontWeights-light:300;--chakra-fontWeights-normal:400;--chakra-fontWeights-medium:500;--chakra-fontWeights-semibold:600;--chakra-fontWeights-bold:700;--chakra-fontWeights-extrabold:800;--chakra-fontWeights-black:900;--chakra-letterSpacings-tighter:-0.05em;--chakra-letterSpacings-tight:-0.025em;--chakra-letterSpacings-normal:0;--chakra-letterSpacings-wide:0.025em;--chakra-letterSpacings-wider:0.05em;--chakra-letterSpacings-widest:0.1em;--chakra-lineHeights-3:.75rem;--chakra-lineHeights-4:1rem;--chakra-lineHeights-5:1.25rem;--chakra-lineHeights-6:1.5rem;--chakra-lineHeights-7:1.75rem;--chakra-lineHeights-8:2rem;--chakra-lineHeights-9:2.25rem;--chakra-lineHeights-10:2.5rem;--chakra-lineHeights-normal:normal;--chakra-lineHeights-none:1;--chakra-lineHeights-shorter:1.25;--chakra-lineHeights-short:1.375;--chakra-lineHeights-base:1.5;--chakra-lineHeights-tall:1.625;--chakra-lineHeights-taller:2;--chakra-radii-none:0;--chakra-radii-sm:0.125rem;--chakra-radii-base:0.25rem;--chakra-radii-md:0.375rem;--chakra-radii-lg:0.5rem;--chakra-radii-xl:0.75rem;--chakra-radii-2xl:1rem;--chakra-radii-3xl:1.5rem;--chakra-radii-full:9999px;--chakra-space-1:0.25rem;--chakra-space-2:0.5rem;--chakra-space-3:0.75rem;--chakra-space-4:1rem;--chakra-space-5:1.25rem;--chakra-space-6:1.5rem;--chakra-space-7:1.75rem;--chakra-space-8:2rem;--chakra-space-9:2.25rem;--chakra-space-10:2.5rem;--chakra-space-12:3rem;--chakra-space-14:3.5rem;--chakra-space-16:4rem;--chakra-space-20:5rem;--chakra-space-24:6rem;--chakra-space-28:7rem;--chakra-space-32:8rem;--chakra-space-36:9rem;--chakra-space-40:10rem;--chakra-space-44:11rem;--chakra-space-48:12rem;--chakra-space-52:13rem;--chakra-space-56:14rem;--chakra-space-60:15rem;--chakra-space-64:16rem;--chakra-space-72:18rem;--chakra-space-80:20rem;--chakra-space-96:24rem;--chakra-space-px:1px;--chakra-space-0-5:0.125rem;--chakra-space-1-5:0.375rem;--chakra-space-2-5:0.625rem;--chakra-space-3-5:0.875rem;--chakra-shadows-xs:0 0 0 1px rgba(0, 0, 0, 0.05);--chakra-shadows-sm:0 1px 2px 0 rgba(0, 0, 0, 0.05);--chakra-shadows-base:0 1px 3px 0 rgba(0, 0, 0, 0.1),0 1px 2px 0 rgba(0, 0, 0, 0.06);--chakra-shadows-md:0 4px 6px -1px rgba(0, 0, 0, 0.1),0 2px 4px -1px rgba(0, 0, 0, 0.06);--chakra-shadows-lg:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);--chakra-shadows-xl:0 20px 25px -5px rgba(0, 0, 0, 0.1),0 10px 10px -5px rgba(0, 0, 0, 0.04);--chakra-shadows-2xl:0 25px 50px -12px rgba(0, 0, 0, 0.25);--chakra-shadows-outline:0 0 0 3px rgba(66, 153, 225, 0.6);--chakra-shadows-inner:inset 0 2px 4px 0 rgba(0,0,0,0.06);--chakra-shadows-none:none;--chakra-shadows-dark-lg:rgba(0, 0, 0, 0.1) 0px 0px 0px 1px,rgba(0, 0, 0, 0.2) 0px 5px 10px,rgba(0, 0, 0, 0.4) 0px 15px 40px;--chakra-sizes-1:0.25rem;--chakra-sizes-2:0.5rem;--chakra-sizes-3:0.75rem;--chakra-sizes-4:1rem;--chakra-sizes-5:1.25rem;--chakra-sizes-6:1.5rem;--chakra-sizes-7:1.75rem;--chakra-sizes-8:2rem;--chakra-sizes-9:2.25rem;--chakra-sizes-10:2.5rem;--chakra-sizes-12:3rem;--chakra-sizes-14:3.5rem;--chakra-sizes-16:4rem;--chakra-sizes-20:5rem;--chakra-sizes-24:6rem;--chakra-sizes-28:7rem;--chakra-sizes-32:8rem;--chakra-sizes-36:9rem;--chakra-sizes-40:10rem;--chakra-sizes-44:11rem;--chakra-sizes-48:12rem;--chakra-sizes-52:13rem;--chakra-sizes-56:14rem;--chakra-sizes-60:15rem;--chakra-sizes-64:16rem;--chakra-sizes-72:18rem;--chakra-sizes-80:20rem;--chakra-sizes-96:24rem;--chakra-sizes-px:1px;--chakra-sizes-0-5:0.125rem;--chakra-sizes-1-5:0.375rem;--chakra-sizes-2-5:0.625rem;--chakra-sizes-3-5:0.875rem;--chakra-sizes-max:max-content;--chakra-sizes-min:min-content;--chakra-sizes-full:100%;--chakra-sizes-3xs:14rem;--chakra-sizes-2xs:16rem;--chakra-sizes-xs:20rem;--chakra-sizes-sm:24rem;--chakra-sizes-md:28rem;--chakra-sizes-lg:32rem;--chakra-sizes-xl:36rem;--chakra-sizes-2xl:42rem;--chakra-sizes-3xl:48rem;--chakra-sizes-4xl:56rem;--chakra-sizes-5xl:64rem;--chakra-sizes-6xl:72rem;--chakra-sizes-7xl:80rem;--chakra-sizes-8xl:90rem;--chakra-sizes-container-sm:640px;--chakra-sizes-container-md:768px;--chakra-sizes-container-lg:1024px;--chakra-sizes-container-xl:1280px;--chakra-zIndices-hide:-1;--chakra-zIndices-auto:auto;--chakra-zIndices-base:0;--chakra-zIndices-docked:10;--chakra-zIndices-dropdown:1000;--chakra-zIndices-sticky:1100;--chakra-zIndices-banner:1200;--chakra-zIndices-overlay:1300;--chakra-zIndices-modal:1400;--chakra-zIndices-popover:1500;--chakra-zIndices-skipLink:1600;--chakra-zIndices-toast:1700;--chakra-zIndices-tooltip:1800;--chakra-transition-property-common:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform;--chakra-transition-property-colors:background-color,border-color,color,fill,stroke;--chakra-transition-property-dimensions:width,height;--chakra-transition-property-position:left,right,top,bottom;--chakra-transition-property-background:background-color,background-image,background-position;--chakra-transition-easing-ease-in:cubic-bezier(0.4, 0, 1, 1);--chakra-transition-easing-ease-out:cubic-bezier(0, 0, 0.2, 1);--chakra-transition-easing-ease-in-out:cubic-bezier(0.4, 0, 0.2, 1);--chakra-transition-duration-ultra-fast:50ms;--chakra-transition-duration-faster:100ms;--chakra-transition-duration-fast:150ms;--chakra-transition-duration-normal:200ms;--chakra-transition-duration-slow:300ms;--chakra-transition-duration-slower:400ms;--chakra-transition-duration-ultra-slow:500ms;--chakra-blur-none:0;--chakra-blur-sm:4px;--chakra-blur-base:8px;--chakra-blur-md:12px;--chakra-blur-lg:16px;--chakra-blur-xl:24px;--chakra-blur-2xl:40px;--chakra-blur-3xl:64px;--chakra-colors-preBg:#262b37;}.chakra-ui-light :host:not([data-theme]),.chakra-ui-light :root:not([data-theme]),.chakra-ui-light [data-theme]:not([data-theme]),[data-theme=light] :host:not([data-theme]),[data-theme=light] :root:not([data-theme]),[data-theme=light] [data-theme]:not([data-theme]),:host[data-theme=light],:root[data-theme=light],[data-theme][data-theme=light]{--chakra-colors-chakra-body-text:var(--chakra-colors-gray-800);--chakra-colors-chakra-body-bg:var(--chakra-colors-white);--chakra-colors-chakra-border-color:var(--chakra-colors-gray-200);--chakra-colors-chakra-placeholder-color:var(--chakra-colors-gray-500);--chakra-colors-textAlpha600:var(--chakra-colors-blackAlpha-600);--chakra-colors-textAlpha800:var(--chakra-colors-blackAlpha-800);--chakra-colors-quoteBg:rgba(0,0,0, 0.05);--chakra-colors-headingAccent:var(--chakra-colors-orange-900);--chakra-colors-anchorAccent:var(--chakra-colors-orange-900);}.chakra-ui-dark :host:not([data-theme]),.chakra-ui-dark :root:not([data-theme]),.chakra-ui-dark [data-theme]:not([data-theme]),[data-theme=dark] :host:not([data-theme]),[data-theme=dark] :root:not([data-theme]),[data-theme=dark] [data-theme]:not([data-theme]),:host[data-theme=dark],:root[data-theme=dark],[data-theme][data-theme=dark]{--chakra-colors-chakra-body-text:var(--chakra-colors-whiteAlpha-900);--chakra-colors-chakra-body-bg:var(--chakra-colors-gray-800);--chakra-colors-chakra-border-color:var(--chakra-colors-whiteAlpha-300);--chakra-colors-chakra-placeholder-color:var(--chakra-colors-whiteAlpha-400);--chakra-colors-textAlpha600:var(--chakra-colors-whiteAlpha-600);--chakra-colors-textAlpha800:var(--chakra-colors-whiteAlpha-800);--chakra-colors-quoteBg:rgba(255, 255, 255, 0.05);--chakra-colors-headingAccent:var(--chakra-colors-orange-100);--chakra-colors-anchorAccent:var(--chakra-colors-orange-100);}</style><style data-emotion="css-global 1orvvh0">html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;touch-action:manipulation;}body{position:relative;min-height:100%;font-feature-settings:'kern';}*,*::before,*::after{border-width:0;border-style:solid;box-sizing:border-box;}main{display:block;}hr{border-top-width:1px;box-sizing:content-box;height:0;overflow:visible;}pre,code,kbd,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:1em;}a{background-color:transparent;color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}b,strong{font-weight:bold;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{-webkit-appearance:none!important;}input[type="number"]{-moz-appearance:textfield;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-decoration{-webkit-appearance:none!important;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:-webkit-box;display:-webkit-list-item;display:-ms-list-itembox;display:list-item;}template{display:none;}[hidden]{display:none!important;}body,blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0;}button{background:transparent;padding:0;}fieldset{margin:0;padding:0;}ol,ul{margin:0;padding:0;}textarea{resize:vertical;}button,[role="button"]{cursor:pointer;}button::-moz-focus-inner{border:0!important;}table{border-collapse:collapse;}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;}img,svg,video,canvas,audio,iframe,embed,object{display:block;}img,video{max-width:100%;height:auto;}[data-js-focus-visible] :focus:not([data-focus-visible-added]):not([data-focus-visible-disabled]){outline:none;box-shadow:none;}select::-ms-expand{display:none;}</style><style data-emotion="css-global 1wxmm51">body{font-family:var(--chakra-fonts-body);color:var(--chakra-colors-chakra-body-text);background:var(--chakra-colors-chakra-body-bg);transition-property:background-color;transition-duration:var(--chakra-transition-duration-normal);line-height:var(--chakra-lineHeights-base);}*::-webkit-input-placeholder{color:var(--chakra-colors-chakra-placeholder-color);}*::-moz-placeholder{color:var(--chakra-colors-chakra-placeholder-color);}*:-ms-input-placeholder{color:var(--chakra-colors-chakra-placeholder-color);}*::placeholder{color:var(--chakra-colors-chakra-placeholder-color);}*,*::before,::after{border-color:var(--chakra-colors-chakra-border-color);word-wrap:break-word;}</style><div><style data-emotion="css gmuwbf">.css-gmuwbf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><div class="css-gmuwbf"><style data-emotion="css 5qxyf1">.css-5qxyf1{width:100%;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;max-width:var(--chakra-sizes-3xl);-webkit-padding-start:1rem;padding-inline-start:1rem;-webkit-padding-end:1rem;padding-inline-end:1rem;}.css-5qxyf1 ul{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;}.css-5qxyf1 li{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;list-style-type:none;padding:var(--chakra-space-4);margin-top:var(--chakra-space-4);}.css-5qxyf1 li:first-of-type{padding-left:0px;}.css-5qxyf1 li a{display:inline-block;color:var(--chakra-colors-textAlpha800);}.css-5qxyf1 li.active{font-weight:var(--chakra-fontWeights-bold);}.css-5qxyf1 li.active a{border-bottom:solid 2px var(--chakra-colors-orange-500);}</style><div class="chakra-container css-5qxyf1"><nav><ul><li class="active"><a href="/articles">Artigos</a></li><li><a href="/">InÃ­cio</a></li><style data-emotion="css 17xejub">.css-17xejub{-webkit-flex:1;-ms-flex:1;flex:1;justify-self:stretch;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;}</style><div class="css-17xejub"></div><li class="left"><style data-emotion="css e9ptzl">.css-e9ptzl{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:2px solid transparent;outline-offset:2px;line-height:1.2;border-radius:var(--chakra-radii-md);font-weight:var(--chakra-fontWeights-semibold);transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-normal);height:var(--chakra-sizes-10);min-width:var(--chakra-sizes-10);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-4);padding-inline-end:var(--chakra-space-4);background:var(--chakra-colors-whiteAlpha-200);}.css-e9ptzl:focus-visible,.css-e9ptzl[data-focus-visible]{box-shadow:var(--chakra-shadows-outline);}.css-e9ptzl[disabled],.css-e9ptzl[aria-disabled=true],.css-e9ptzl[data-disabled]{opacity:0.4;cursor:not-allowed;box-shadow:var(--chakra-shadows-none);}.css-e9ptzl:hover,.css-e9ptzl[data-hover]{background:var(--chakra-colors-whiteAlpha-300);}.css-e9ptzl:hover[disabled],.css-e9ptzl[data-hover][disabled],.css-e9ptzl:hover[aria-disabled=true],.css-e9ptzl[data-hover][aria-disabled=true],.css-e9ptzl:hover[data-disabled],.css-e9ptzl[data-hover][data-disabled]{background:var(--chakra-colors-whiteAlpha-200);}.css-e9ptzl:active,.css-e9ptzl[data-active]{background:var(--chakra-colors-whiteAlpha-400);}</style><button type="button" class="chakra-button css-e9ptzl"><style data-emotion="css onkibi">.css-onkibi{width:1em;height:1em;display:inline-block;line-height:1em;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:currentColor;vertical-align:middle;}</style><svg viewBox="0 0 24 24" focusable="false" class="chakra-icon css-onkibi"><path fill="currentColor" d="M21.4,13.7C20.6,13.9,19.8,14,19,14c-5,0-9-4-9-9c0-0.8,0.1-1.6,0.3-2.4c0.1-0.3,0-0.7-0.3-1 c-0.3-0.3-0.6-0.4-1-0.3C4.3,2.7,1,7.1,1,12c0,6.1,4.9,11,11,11c4.9,0,9.3-3.3,10.6-8.1c0.1-0.3,0-0.7-0.3-1 C22.1,13.7,21.7,13.6,21.4,13.7z"></path></svg></button></li></ul></nav></div></div><style data-emotion="css 1bt7hoq">.css-1bt7hoq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;margin-top:var(--chakra-space-8);}</style><main class="css-1bt7hoq"><style data-emotion="css e10fi8">.css-e10fi8{width:100%;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;max-width:var(--chakra-sizes-3xl);-webkit-padding-start:1rem;padding-inline-start:1rem;-webkit-padding-end:1rem;padding-inline-end:1rem;position:relative;}</style><div class="chakra-container css-e10fi8"><style data-emotion="css 69leel">.css-69leel{position:absolute;color:var(--chakra-colors-textAlpha600);top:calc(var(--chakra-space-6) * -1);}</style><div class="css-69leel"><span class="date">07<!-- --> / <!-- -->2022</span></div><style data-emotion="css ax13w1">.css-ax13w1{padding-bottom:6rem;}.css-ax13w1 h1{font-size:var(--chakra-fontSizes-3xl);font-weight:var(--chakra-fontWeights-bold);margin-top:var(--chakra-space-8);margin-bottom:var(--chakra-space-2);display:inline-block;border-bottom:solid 3px var(--chakra-colors-orange-500);width:100%;padding-bottom:var(--chakra-space-3);border-radius:4px;}.css-ax13w1 h1:first-of-type{margin-top:0px;}.css-ax13w1 h1+h2{margin-top:var(--chakra-space-4);}.css-ax13w1 h2{color:var(--chakra-colors-headingAccent);font-weight:var(--chakra-fontWeights-bold);font-size:var(--chakra-fontSizes-2xl);margin-top:var(--chakra-space-10);margin-bottom:var(--chakra-space-4);}.css-ax13w1 h3{color:var(--chakra-colors-headingAccent);font-size:var(--chakra-fontSizes-xl);margin-top:var(--chakra-space-6);}.css-ax13w1 p{margin-top:var(--chakra-space-4);margin-bottom:var(--chakra-space-4);}.css-ax13w1 pre{margin-top:var(--chakra-space-6);margin-bottom:var(--chakra-space-6);padding:var(--chakra-space-6);-webkit-margin-start:calc(var(--chakra-space-6) * -1);margin-inline-start:calc(var(--chakra-space-6) * -1);-webkit-margin-end:calc(var(--chakra-space-6) * -1);margin-inline-end:calc(var(--chakra-space-6) * -1);background-color:var(--chakra-colors-preBg);border-radius:4px;color:var(--chakra-colors-white);min-width:calc(100% + var(--chakra-space-12));width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;}.css-ax13w1 ul,.css-ax13w1 ol{margin-left:2rem;}.css-ax13w1 li{margin-top:var(--chakra-space-3);margin-bottom:var(--chakra-space-3);}.css-ax13w1 p code,.css-ax13w1 ul code{background-color:var(--chakra-colors-quoteBg);}.css-ax13w1 blockquote{border-left:solid 3px var(--chakra-colors-orange-200);margin-top:var(--chakra-space-6);margin-bottom:var(--chakra-space-6);-webkit-padding-start:var(--chakra-space-6);padding-inline-start:var(--chakra-space-6);-webkit-padding-end:var(--chakra-space-6);padding-inline-end:var(--chakra-space-6);padding-top:var(--chakra-space-2);padding-bottom:var(--chakra-space-2);-webkit-margin-start:calc(var(--chakra-space-6) * -1);margin-inline-start:calc(var(--chakra-space-6) * -1);-webkit-margin-end:calc(var(--chakra-space-6) * -1);margin-inline-end:calc(var(--chakra-space-6) * -1);background-color:var(--chakra-colors-quoteBg);border-radius:4px;}.css-ax13w1 blockquote>:first-of-type{margin-top:0px;}.css-ax13w1 blockquote>:last-of-type{margin-bottom:0px;}.css-ax13w1 a{color:var(--chakra-colors-anchorAccent);-webkit-text-decoration:underline;text-decoration:underline;text-decoration-style:dotted;}.css-ax13w1 img{margin-top:var(--chakra-space-10);margin-bottom:var(--chakra-space-10);}</style><main class="mdcontent css-ax13w1" id="mdcontent"><h1>Post-review: Migrating CRA to Vite</h1>
<h2>Previous state</h2>
<p>Create-react-app application takes around 3 minutes to build, requiring around 3GB of RAM.</p>
<h2>Why Vite</h2>
<ul>
<li>We wanted a quick frictionless migration (so picking a framework like Next is out of scope);</li>
<li>We wanted to avoid low level tools. We want something well-mantained with a good preset out of the box;</li>
<li>It looks like Vite achieved these goals, other similar tooling might have too;</li>
</ul>
<h2>Migration tweaks</h2>
<p>This might change a bit depending on what kind of stuff you have in your project. Here&#x27;s what we had:</p>
<h3>Initial setup</h3>
<ul>
<li>Vite&#x27;s docs doesn&#x27;t have any article about &quot;migrating from an existing project&quot;; So I have launched a starter project and copied the following files:<!-- -->
<ul>
<li><code>vite.config.ts</code></li>
<li><code>tsconfig.json</code> (adapt accordingly)</li>
<li><code>tsconfig.node.json</code></li>
</ul>
</li>
<li>Review the <code>package.json</code> and remove anything related to Create React App, Babel or Webpack. For instance:<!-- -->
<ul>
<li><code>react-scripts</code></li>
</ul>
</li>
<li>Also replace the package.json&#x27;s scripts accordingly. Ex:</li>
</ul>
<pre><code>Â  Â  &quot;vite&quot;: &quot;vite&quot;,
Â  Â  &quot;start&quot;: &quot;vite&quot;,
Â  Â  &quot;build&quot;: &quot;vite build&quot;,
Â  Â  &quot;preview&quot;: &quot;vite preview&quot;,
Â  Â  &quot;test&quot;: &quot;vitest --run&quot;,
Â  Â  &quot;test:watch&quot;: &quot;vitest&quot;,
</code></pre>
<ul>
<li>Add Vite (<code>yarn add vite</code>). Update TS to the latest version since you don&#x27;t have CRA locking you to an ancient version anymore;</li>
</ul>
<h2>React plugin</h2>
<p>One of the first things to add is the React plugin in the Vite Config. (<code>@vitejs/plugin/react</code>).</p>
<p>Below is shown the final version of the vite config:</p>
<pre class="language-ts"><code class="language-ts"><span class="token comment">/// &lt;reference types=&quot;vitest&quot; /&gt;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;vite&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports">react</span> <span class="token keyword module">from</span> <span class="token string">&#x27;@vitejs/plugin-react&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> resolve<span class="token punctuation">,</span> parse <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;path&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> fs</span> <span class="token keyword module">from</span> <span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports">svgr</span> <span class="token keyword module">from</span> <span class="token string">&#x27;vite-plugin-svgr&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> rootPaths <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readdirSync</span><span class="token punctuation">(</span><span class="token string">&#x27;src&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> parsed <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span>out<span class="token punctuation">,</span> <span class="token punctuation">[</span>parsed<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#x27;src&#x27;</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">svgr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">react</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> rootPaths<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  envPrefix<span class="token operator">:</span> <span class="token string">&#x27;REACT_APP&#x27;</span><span class="token punctuation">,</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    globals<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    environment<span class="token operator">:</span> <span class="token string">&#x27;happy-dom&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2>Path mapping</h2>
<p>In CRA, folders at the source root can be acessed as absolute paths.</p>
<ul>
<li>I.e. <code>/src/ListComponent/Somefile.ts</code> can be imported as</li>
<li><code>import Somefile from &#x27;ListComponent/Somefile&#x27;</code></li>
</ul>
<p>This special handling doesn&#x27;t exist on Vite. I have then manually stitched this mapping on vite config&#x27;s <code>resolve.alias</code> setting.</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> rootPaths <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readdirSync</span><span class="token punctuation">(</span><span class="token string">&#x27;src&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> parsed <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span>out<span class="token punctuation">,</span> <span class="token punctuation">[</span>parsed<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#x27;src&#x27;</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ..</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> rootPaths<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2>SVG Imports</h2>
<p>Create React App embeds the &quot;SVGR&quot; library. If you use any import like...</p>
<pre class="language-tsx"><code class="language-tsx"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">ReactComponent</span> <span class="token keyword module">as</span> <span class="token maybe-class-name">MySvg</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;./file.svg&#x27;</span>
</code></pre>
<p>...then this won&#x27;t work anymore.</p>
<p>A frictionless fix was to add the <code>vite-plugin-svgr</code> shown above (found in a Stack Overflow reply).</p>
<blockquote>
<p>Vite is based on Rollup, and SVGR provides its own Rollup plugin, <code>@svgr/rollup</code>. Unfortunately this seemed not to work properly here because Vite already embeds a static file URL plugin, which takes higher precedence. Even following the provided steps to use it alongside the URL plugin didn&#x27;t work well.</p>
</blockquote>
<h2>Environment variables</h2>
<p>Vite doesnt read environment variables from <code>process.env</code>, but rather from <code>import.meta.env</code>; Also, the <code>NODE_ENV</code> variable is found on the <code>import.meta.env.mode</code>, which is set according to the build environment used (Vite dev server, Vite build or vitest);</p>
<p>Some badly tasting environment variables like <code>BROWSER=none</code> or <code>PORT</code> won&#x27;t be needed anymore (Vite&#x27;s server accepts a <code>--port</code> argument like 99% of other software in the world).</p>
<p>The default environment variable <em>safe prefix</em> is <code>VITE_APP</code> instead of <code>REACT_APP</code>. This can be changed on the <code>envPrefix</code> setting (as shown above), as to avoid some refactoring.</p>
<h2>Type defs</h2>
<p>If you previously worked on a strictly typed <code>process.env</code>, you may need to move those types to the corresponding global interfaces <code>ImportMetaEnv</code> and <code>ImportMeta</code>, as shown on the <a href="https://vitejs.dev/guide/env-and-mode.html#env-files">environment variable docs.</a>;</p>
<p>We also need to replace the build tool types. On react.app-env.d.ts, replace:</p>
<pre class="language-diff"><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> /// &lt;reference types=&quot;react-scripts&quot; /&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> /// &lt;reference types=&quot;vite/client&quot; /&gt;
</span></span></code></pre>
<h2>The index.html</h2>
<p>The <code>index.html</code> now lives in the root folder. It also requires a new script tag on its body, pointing to the project root:</p>
<pre class="language-html"><code class="language-html">Â  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
Â  Â  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
Â  Â  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/src/index.tsx<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span> Â  Â 
Â  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>Also, any <code>%PUBLIC_URL%</code> tags must be removed.</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%PUBLIC_URL%/favicon.ico<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre>
<h2>Refactor sync require()&#x27;s</h2>
<p>On webpack you could still get away with writing a synchronous CommonJS <code>require()</code> anywhere. On Vite this simply won&#x27;t work out (unless maybe with a plugin);</p>
<h2>Default build folder</h2>
<p>The default build folder on Vite is <code>dist</code> instead of <code>build</code>. This can be tweaked with <code>build.outDir</code>.</p>
<h2>Testing</h2>
<p>The quickest way around testing is probably swithing to <em>Vitest</em>, as the Jest test runner kinda relies on Babel/Webpack;</p>
<p>We still kept Jest on the project, we&#x27;re just not using its <strong>test runner</strong> anymore. Other parts of Jest like assertions or mocks are still there.</p>
<p><em>Vitest</em> reads from the same config file (<code>vite.config.ts</code>). You need to add its type directive for TS not to complain:</p>
<pre class="language-ts"><code class="language-ts"><span class="token comment">// on vite.config.ts:</span>
<span class="token comment">/// &lt;reference types=&quot;vitest&quot; /&gt;</span>
</code></pre>
<p>As shown before, we needed a couple extra settings on the &quot;test&quot; key.</p>
<pre><code>Â  test: {
Â  Â  globals: true,
Â  Â  environment: &#x27;happy-dom&#x27;,
Â  },
</code></pre>
<ul>
<li><strong>globals</strong> adds the mocha-like globals (<code>describe</code>, <code>test</code>, etc) to the context;</li>
<li><strong>environment</strong> allows you to enable JSDOM or other;</li>
<li>When you set an environment, the CLI will suggest you to separately install it.</li>
</ul>
<h2>ESLint</h2>
<blockquote>
<p><strong>Update - 08/2022</strong>: The config set below is harder to set up and not ideal. Instead, install the
<code>react-app</code> eslint plugin, as described on <a href="https://www.npmjs.com/package/eslint-config-react-app">their docs</a>.</p>
</blockquote>
<p>Many ESLint plugins that were previously bundled with CRA had to be manually installed and added.</p>
<ul>
<li>@typescript-eslint/eslint-plugin</li>
<li>@typescript-eslint/parser</li>
<li>eslint-plugin-jsx-a11y</li>
<li>eslint-plugin-react</li>
<li>eslint-plugin-react-hooks</li>
</ul>
<p>We ended up with something like this on the  <code>eslint.config</code>:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
Â  <span class="token property">&quot;root&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
Â  <span class="token property">&quot;parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@typescript-eslint/parser&quot;</span><span class="token punctuation">,</span>
Â  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
Â  Â  <span class="token string">&quot;@typescript-eslint&quot;</span><span class="token punctuation">,</span>
Â  Â  <span class="token string">&quot;react-hooks&quot;</span><span class="token punctuation">,</span>
Â  Â  <span class="token string">&quot;jsx-a11y&quot;</span>
Â  <span class="token punctuation">]</span><span class="token punctuation">,</span>
Â  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
Â  Â  <span class="token string">&quot;plugin:react/recommended&quot;</span><span class="token punctuation">,</span>
Â  Â  <span class="token string">&quot;plugin:import/recommended&quot;</span><span class="token punctuation">,</span>
Â  Â  <span class="token string">&quot;plugin:import/typescript&quot;</span><span class="token punctuation">,</span>
Â  <span class="token punctuation">]</span><span class="token punctuation">,</span>
Â  <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
Â  Â  <span class="token property">&quot;react&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
Â  Â  Â  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;17.0&quot;</span>
Â  Â  <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2>Build and development</h2>
<p>The Vite Dev server does not automatically include TS checking. It suggests you to run <code>tsc</code> on the build task (<code>tsc &amp;&amp; vite build</code>). The tsconfig is already suggested with a <code>noEmit</code>.</p>
<p>While you may probably add <code>tsc</code> to the build through a plugin, in the end I think it is better not to, since VSCode already runs its own TS Server. Running <code>tsc</code> on the development server creates a duplicate TS Server.</p>
<p>In case you&#x27;d like to check errors project-wide:</p>
<ul>
<li>you may still run <code>tsc -w</code></li>
<li>or use a VS Code Task: F1 &gt; Run Build Task &gt; tsc - watch</li>
</ul>
<p>Since type checking and building are now separate tasks, you may run them on <em>parallel</em> on the CI.</p>
<h2>Performance feelings</h2>
<p>Build time went to around 25 seconds down from 3 min (could be lower if I hadn&#x27;t disabled SMT on my processor); While Webpack uses only a single core during most of the build, Vite displays some average activity on all cores.</p>
<p>Peak memory usage went to 1,2GB, down from ~3GB.</p>
<ul>
<li>The development server starts right away, since it actually didn&#x27;t compile anything. Pages are compiled as you load them (similar to what happens on Next.js). The development mode may not feel THAT fast on a first page load, since every dependency is served individually. If you look at the requests pane, you can see an enormous number of files being served;</li>
<li>Nonetheless, it is orders faster than Webpacks 3-minute build-of-everything;</li>
<li>Only the files required by a specific page are compiled and served;</li>
<li>This also means that when performing HMR, only the changed files are re-served. HMR feels more responsive;</li>
<li>This may also mean that once the first load is done, the browser may leverage caching of individual files on its side;</li>
<li>On the production mode, the files are bundled more like it happens on other traditional tools. Development and production builds are considerably different from each other. The differences are explained right on the <a href="https://vitejs.dev/guide/why.html">first page of the docs</a>.</li>
</ul></main></div></main></div><span></span><span hidden="" class="chakra-env"></span></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"articlesDetail":{"year":"2022","month":"07","folder":"../md/2022-07-ret-cra-to-vite","slug":"2022-07-ret-cra-to-vite","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    h2: \"h2\",\n    p: \"p\",\n    ul: \"ul\",\n    li: \"li\",\n    h3: \"h3\",\n    code: \"code\",\n    pre: \"pre\",\n    span: \"span\",\n    blockquote: \"blockquote\",\n    em: \"em\",\n    a: \"a\",\n    strong: \"strong\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.h1, {\n      children: \"Post-review: Migrating CRA to Vite\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Previous state\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Create-react-app application takes around 3 minutes to build, requiring around 3GB of RAM.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Why Vite\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"We wanted a quick frictionless migration (so picking a framework like Next is out of scope);\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"We wanted to avoid low level tools. We want something well-mantained with a good preset out of the box;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"It looks like Vite achieved these goals, other similar tooling might have too;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Migration tweaks\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This might change a bit depending on what kind of stuff you have in your project. Here's what we had:\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Initial setup\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"Vite's docs doesn't have any article about \\\"migrating from an existing project\\\"; So I have launched a starter project and copied the following files:\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsx(_components.li, {\n            children: _jsx(_components.code, {\n              children: \"vite.config.ts\"\n            })\n          }), \"\\n\", _jsxs(_components.li, {\n            children: [_jsx(_components.code, {\n              children: \"tsconfig.json\"\n            }), \" (adapt accordingly)\"]\n          }), \"\\n\", _jsx(_components.li, {\n            children: _jsx(_components.code, {\n              children: \"tsconfig.node.json\"\n            })\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Review the \", _jsx(_components.code, {\n          children: \"package.json\"\n        }), \" and remove anything related to Create React App, Babel or Webpack. For instance:\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsx(_components.li, {\n            children: _jsx(_components.code, {\n              children: \"react-scripts\"\n            })\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Also replace the package.json's scripts accordingly. Ex:\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"Â  Â  \\\"vite\\\": \\\"vite\\\",\\nÂ  Â  \\\"start\\\": \\\"vite\\\",\\nÂ  Â  \\\"build\\\": \\\"vite build\\\",\\nÂ  Â  \\\"preview\\\": \\\"vite preview\\\",\\nÂ  Â  \\\"test\\\": \\\"vitest --run\\\",\\nÂ  Â  \\\"test:watch\\\": \\\"vitest\\\",\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"Add Vite (\", _jsx(_components.code, {\n          children: \"yarn add vite\"\n        }), \"). Update TS to the latest version since you don't have CRA locking you to an ancient version anymore;\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"React plugin\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"One of the first things to add is the React plugin in the Vite Config. (\", _jsx(_components.code, {\n        children: \"@vitejs/plugin/react\"\n      }), \").\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Below is shown the final version of the vite config:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-ts\",\n      children: _jsxs(_components.code, {\n        className: \"language-ts\",\n        children: [_jsx(_components.span, {\n          className: \"token comment\",\n          children: \"/// \u003creference types=\\\"vitest\\\" /\u003e\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"import\"\n        }), \" \", _jsxs(_components.span, {\n          className: \"token imports\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \" defineConfig \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          })]\n        }), \" \", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"from\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'vite'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token imports\",\n          children: \"react\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"from\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'@vitejs/plugin-react'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"import\"\n        }), \" \", _jsxs(_components.span, {\n          className: \"token imports\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \" resolve\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" parse \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          })]\n        }), \" \", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"from\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'path'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"import\"\n        }), \" \", _jsxs(_components.span, {\n          className: \"token imports\",\n          children: [_jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword module\",\n            children: \"as\"\n          }), \" fs\"]\n        }), \" \", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"from\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'fs'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token imports\",\n          children: \"svgr\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"from\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'vite-plugin-svgr'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"const\"\n        }), \" rootPaths \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \" fs\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token method function property-access\",\n          children: \"readdirSync\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'src'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token method function property-access\",\n          children: \"reduce\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), \"out\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" item\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token arrow operator\",\n          children: \"=\u003e\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"const\"\n        }), \" parsed \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"parse\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), \"item\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token keyword control-flow\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token spread operator\",\n          children: \"...\"\n        }), \"out\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"[\"\n        }), \"parsed\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token property-access\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"]\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"resolve\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'src'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" item\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// https://vitejs.dev/config/\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"export\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"default\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"defineConfig\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n  plugins\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"[\"\n        }), _jsx(_components.span, {\n          className: \"token function\",\n          children: \"svgr\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"react\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"]\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\n  resolve\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n    alias\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" rootPaths\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\n  envPrefix\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'REACT_APP'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\n  test\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n    globals\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token boolean\",\n          children: \"true\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\n    environment\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'happy-dom'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Path mapping\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In CRA, folders at the source root can be acessed as absolute paths.\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"I.e. \", _jsx(_components.code, {\n          children: \"/src/ListComponent/Somefile.ts\"\n        }), \" can be imported as\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.code, {\n          children: \"import Somefile from 'ListComponent/Somefile'\"\n        })\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This special handling doesn't exist on Vite. I have then manually stitched this mapping on vite config's \", _jsx(_components.code, {\n        children: \"resolve.alias\"\n      }), \" setting.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-ts\",\n      children: _jsxs(_components.code, {\n        className: \"language-ts\",\n        children: [_jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"const\"\n        }), \" rootPaths \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \" fs\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token method function property-access\",\n          children: \"readdirSync\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'src'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token method function property-access\",\n          children: \"reduce\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), \"out\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" item\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token arrow operator\",\n          children: \"=\u003e\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"const\"\n        }), \" parsed \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"parse\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), \"item\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token keyword control-flow\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token spread operator\",\n          children: \"...\"\n        }), \"out\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"[\"\n        }), \"parsed\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token property-access\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"]\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"resolve\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'src'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" item\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"export\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"default\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"defineConfig\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// ..\"\n        }), \"\\n  resolve\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n    alias\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" rootPaths\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"SVG Imports\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Create React App embeds the \\\"SVGR\\\" library. If you use any import like...\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-tsx\",\n      children: _jsxs(_components.code, {\n        className: \"language-tsx\",\n        children: [_jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"import\"\n        }), \" \", _jsxs(_components.span, {\n          className: \"token imports\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token maybe-class-name\",\n            children: \"ReactComponent\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword module\",\n            children: \"as\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token maybe-class-name\",\n            children: \"MySvg\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          })]\n        }), \" \", _jsx(_components.span, {\n          className: \"token keyword module\",\n          children: \"from\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'./file.svg'\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"...then this won't work anymore.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"A frictionless fix was to add the \", _jsx(_components.code, {\n        children: \"vite-plugin-svgr\"\n      }), \" shown above (found in a Stack Overflow reply).\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsxs(_components.p, {\n        children: [\"Vite is based on Rollup, and SVGR provides its own Rollup plugin, \", _jsx(_components.code, {\n          children: \"@svgr/rollup\"\n        }), \". Unfortunately this seemed not to work properly here because Vite already embeds a static file URL plugin, which takes higher precedence. Even following the provided steps to use it alongside the URL plugin didn't work well.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Environment variables\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Vite doesnt read environment variables from \", _jsx(_components.code, {\n        children: \"process.env\"\n      }), \", but rather from \", _jsx(_components.code, {\n        children: \"import.meta.env\"\n      }), \"; Also, the \", _jsx(_components.code, {\n        children: \"NODE_ENV\"\n      }), \" variable is found on the \", _jsx(_components.code, {\n        children: \"import.meta.env.mode\"\n      }), \", which is set according to the build environment used (Vite dev server, Vite build or vitest);\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Some badly tasting environment variables like \", _jsx(_components.code, {\n        children: \"BROWSER=none\"\n      }), \" or \", _jsx(_components.code, {\n        children: \"PORT\"\n      }), \" won't be needed anymore (Vite's server accepts a \", _jsx(_components.code, {\n        children: \"--port\"\n      }), \" argument like 99% of other software in the world).\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The default environment variable \", _jsx(_components.em, {\n        children: \"safe prefix\"\n      }), \" is \", _jsx(_components.code, {\n        children: \"VITE_APP\"\n      }), \" instead of \", _jsx(_components.code, {\n        children: \"REACT_APP\"\n      }), \". This can be changed on the \", _jsx(_components.code, {\n        children: \"envPrefix\"\n      }), \" setting (as shown above), as to avoid some refactoring.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Type defs\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you previously worked on a strictly typed \", _jsx(_components.code, {\n        children: \"process.env\"\n      }), \", you may need to move those types to the corresponding global interfaces \", _jsx(_components.code, {\n        children: \"ImportMetaEnv\"\n      }), \" and \", _jsx(_components.code, {\n        children: \"ImportMeta\"\n      }), \", as shown on the \", _jsx(_components.a, {\n        href: \"https://vitejs.dev/guide/env-and-mode.html#env-files\",\n        children: \"environment variable docs.\"\n      }), \";\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We also need to replace the build tool types. On react.app-env.d.ts, replace:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-diff\",\n      children: _jsxs(_components.code, {\n        className: \"language-diff\",\n        children: [_jsxs(_components.span, {\n          className: \"token deleted-sign deleted\",\n          children: [_jsx(_components.span, {\n            className: \"token prefix deleted\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token line\",\n            children: \" /// \u003creference types=\\\"react-scripts\\\" /\u003e\\n\"\n          })]\n        }), _jsxs(_components.span, {\n          className: \"token inserted-sign inserted\",\n          children: [_jsx(_components.span, {\n            className: \"token prefix inserted\",\n            children: \"+\"\n          }), _jsx(_components.span, {\n            className: \"token line\",\n            children: \" /// \u003creference types=\\\"vite/client\\\" /\u003e\\n\"\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"The index.html\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The \", _jsx(_components.code, {\n        children: \"index.html\"\n      }), \" now lives in the root folder. It also requires a new script tag on its body, pointing to the project root:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-html\",\n      children: _jsxs(_components.code, {\n        className: \"language-html\",\n        children: [\"Â  \", _jsxs(_components.span, {\n          className: \"token tag\",\n          children: [_jsxs(_components.span, {\n            className: \"token tag\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\u003c\"\n            }), \"body\"]\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\u003e\"\n          })]\n        }), \"\\nÂ  Â  \", _jsxs(_components.span, {\n          className: \"token tag\",\n          children: [_jsxs(_components.span, {\n            className: \"token tag\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\u003c\"\n            }), \"div\"]\n          }), \" \", _jsx(_components.span, {\n            className: \"token attr-name\",\n            children: \"id\"\n          }), _jsxs(_components.span, {\n            className: \"token attr-value\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation attr-equals\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\\\"\"\n            }), \"root\", _jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\\\"\"\n            })]\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\u003e\"\n          })]\n        }), _jsxs(_components.span, {\n          className: \"token tag\",\n          children: [_jsxs(_components.span, {\n            className: \"token tag\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\u003c/\"\n            }), \"div\"]\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\u003e\"\n          })]\n        }), \"\\nÂ  Â  \", _jsxs(_components.span, {\n          className: \"token tag\",\n          children: [_jsxs(_components.span, {\n            className: \"token tag\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\u003c\"\n            }), \"script\"]\n          }), \" \", _jsx(_components.span, {\n            className: \"token attr-name\",\n            children: \"type\"\n          }), _jsxs(_components.span, {\n            className: \"token attr-value\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation attr-equals\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\\\"\"\n            }), \"module\", _jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\\\"\"\n            })]\n          }), \" \", _jsx(_components.span, {\n            className: \"token attr-name\",\n            children: \"src\"\n          }), _jsxs(_components.span, {\n            className: \"token attr-value\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation attr-equals\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\\\"\"\n            }), \"/src/index.tsx\", _jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\\\"\"\n            })]\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\u003e\"\n          })]\n        }), _jsx(_components.span, {\n          className: \"token script\"\n        }), _jsxs(_components.span, {\n          className: \"token tag\",\n          children: [_jsxs(_components.span, {\n            className: \"token tag\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\u003c/\"\n            }), \"script\"]\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\u003e\"\n          })]\n        }), \" Â  Â \\nÂ  \", _jsxs(_components.span, {\n          className: \"token tag\",\n          children: [_jsxs(_components.span, {\n            className: \"token tag\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\u003c/\"\n            }), \"body\"]\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\u003e\"\n          })]\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Also, any \", _jsx(_components.code, {\n        children: \"%PUBLIC_URL%\"\n      }), \" tags must be removed.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-html\",\n      children: _jsxs(_components.code, {\n        className: \"language-html\",\n        children: [_jsxs(_components.span, {\n          className: \"token tag\",\n          children: [_jsxs(_components.span, {\n            className: \"token tag\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\u003c\"\n            }), \"link\"]\n          }), \" \", _jsx(_components.span, {\n            className: \"token attr-name\",\n            children: \"rel\"\n          }), _jsxs(_components.span, {\n            className: \"token attr-value\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation attr-equals\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\\\"\"\n            }), \"icon\", _jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\\\"\"\n            })]\n          }), \" \", _jsx(_components.span, {\n            className: \"token attr-name\",\n            children: \"href\"\n          }), _jsxs(_components.span, {\n            className: \"token attr-value\",\n            children: [_jsx(_components.span, {\n              className: \"token punctuation attr-equals\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\\\"\"\n            }), \"%PUBLIC_URL%/favicon.ico\", _jsx(_components.span, {\n              className: \"token punctuation\",\n              children: \"\\\"\"\n            })]\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"/\u003e\"\n          })]\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Refactor sync require()'s\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"On webpack you could still get away with writing a synchronous CommonJS \", _jsx(_components.code, {\n        children: \"require()\"\n      }), \" anywhere. On Vite this simply won't work out (unless maybe with a plugin);\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Default build folder\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The default build folder on Vite is \", _jsx(_components.code, {\n        children: \"dist\"\n      }), \" instead of \", _jsx(_components.code, {\n        children: \"build\"\n      }), \". This can be tweaked with \", _jsx(_components.code, {\n        children: \"build.outDir\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Testing\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The quickest way around testing is probably swithing to \", _jsx(_components.em, {\n        children: \"Vitest\"\n      }), \", as the Jest test runner kinda relies on Babel/Webpack;\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We still kept Jest on the project, we're just not using its \", _jsx(_components.strong, {\n        children: \"test runner\"\n      }), \" anymore. Other parts of Jest like assertions or mocks are still there.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.em, {\n        children: \"Vitest\"\n      }), \" reads from the same config file (\", _jsx(_components.code, {\n        children: \"vite.config.ts\"\n      }), \"). You need to add its type directive for TS not to complain:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-ts\",\n      children: _jsxs(_components.code, {\n        className: \"language-ts\",\n        children: [_jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// on vite.config.ts:\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"/// \u003creference types=\\\"vitest\\\" /\u003e\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"As shown before, we needed a couple extra settings on the \\\"test\\\" key.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"Â  test: {\\nÂ  Â  globals: true,\\nÂ  Â  environment: 'happy-dom',\\nÂ  },\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"globals\"\n        }), \" adds the mocha-like globals (\", _jsx(_components.code, {\n          children: \"describe\"\n        }), \", \", _jsx(_components.code, {\n          children: \"test\"\n        }), \", etc) to the context;\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"environment\"\n        }), \" allows you to enable JSDOM or other;\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"When you set an environment, the CLI will suggest you to separately install it.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"ESLint\"\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.strong, {\n          children: \"Update - 08/2022\"\n        }), \": The config set below is harder to set up and not ideal. Instead, install the\\n\", _jsx(_components.code, {\n          children: \"react-app\"\n        }), \" eslint plugin, as described on \", _jsx(_components.a, {\n          href: \"https://www.npmjs.com/package/eslint-config-react-app\",\n          children: \"their docs\"\n        }), \".\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Many ESLint plugins that were previously bundled with CRA had to be manually installed and added.\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"@typescript-eslint/eslint-plugin\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"@typescript-eslint/parser\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"eslint-plugin-jsx-a11y\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"eslint-plugin-react\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"eslint-plugin-react-hooks\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We ended up with something like this on the  \", _jsx(_components.code, {\n        children: \"eslint.config\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-json\",\n      children: _jsxs(_components.code, {\n        className: \"language-json\",\n        children: [_jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\nÂ  \", _jsx(_components.span, {\n          className: \"token property\",\n          children: \"\\\"root\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token boolean\",\n          children: \"true\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\nÂ  \", _jsx(_components.span, {\n          className: \"token property\",\n          children: \"\\\"parser\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"@typescript-eslint/parser\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\nÂ  \", _jsx(_components.span, {\n          className: \"token property\",\n          children: \"\\\"plugins\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"[\"\n        }), \"\\nÂ  Â  \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"@typescript-eslint\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\nÂ  Â  \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"react-hooks\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\nÂ  Â  \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"jsx-a11y\\\"\"\n        }), \"\\nÂ  \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"]\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\nÂ  \", _jsx(_components.span, {\n          className: \"token property\",\n          children: \"\\\"extends\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"[\"\n        }), \"\\nÂ  Â  \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"plugin:react/recommended\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\nÂ  Â  \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"plugin:import/recommended\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\nÂ  Â  \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"plugin:import/typescript\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\nÂ  \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"]\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \"\\nÂ  \", _jsx(_components.span, {\n          className: \"token property\",\n          children: \"\\\"settings\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\nÂ  Â  \", _jsx(_components.span, {\n          className: \"token property\",\n          children: \"\\\"react\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\nÂ  Â  Â  \", _jsx(_components.span, {\n          className: \"token property\",\n          children: \"\\\"version\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"17.0\\\"\"\n        }), \"\\nÂ  Â  \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Build and development\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The Vite Dev server does not automatically include TS checking. It suggests you to run \", _jsx(_components.code, {\n        children: \"tsc\"\n      }), \" on the build task (\", _jsx(_components.code, {\n        children: \"tsc \u0026\u0026 vite build\"\n      }), \"). The tsconfig is already suggested with a \", _jsx(_components.code, {\n        children: \"noEmit\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"While you may probably add \", _jsx(_components.code, {\n        children: \"tsc\"\n      }), \" to the build through a plugin, in the end I think it is better not to, since VSCode already runs its own TS Server. Running \", _jsx(_components.code, {\n        children: \"tsc\"\n      }), \" on the development server creates a duplicate TS Server.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In case you'd like to check errors project-wide:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"you may still run \", _jsx(_components.code, {\n          children: \"tsc -w\"\n        })]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"or use a VS Code Task: F1 \u003e Run Build Task \u003e tsc - watch\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Since type checking and building are now separate tasks, you may run them on \", _jsx(_components.em, {\n        children: \"parallel\"\n      }), \" on the CI.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Performance feelings\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Build time went to around 25 seconds down from 3 min (could be lower if I hadn't disabled SMT on my processor); While Webpack uses only a single core during most of the build, Vite displays some average activity on all cores.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Peak memory usage went to 1,2GB, down from ~3GB.\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"The development server starts right away, since it actually didn't compile anything. Pages are compiled as you load them (similar to what happens on Next.js). The development mode may not feel THAT fast on a first page load, since every dependency is served individually. If you look at the requests pane, you can see an enormous number of files being served;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Nonetheless, it is orders faster than Webpacks 3-minute build-of-everything;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Only the files required by a specific page are compiled and served;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"This also means that when performing HMR, only the changed files are re-served. HMR feels more responsive;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"This may also mean that once the first load is done, the browser may leverage caching of individual files on its side;\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"On the production mode, the files are bundled more like it happens on other traditional tools. Development and production builds are considerably different from each other. The differences are explained right on the \", _jsx(_components.a, {\n          href: \"https://vitejs.dev/guide/why.html\",\n          children: \"first page of the docs\"\n        }), \".\"]\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}},"title":"Post-review: Migrating CRA to Vite"}},"__N_SSG":true},"page":"/articles/[slug]","query":{"slug":"2022-07-ret-cra-to-vite"},"buildId":"Rj-u9m2TXNHyaCr0beF96","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>